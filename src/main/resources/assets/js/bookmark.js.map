{"version":3,"file":"bookmark.js","names":["main","window","addEventListener","e","newURL","repositoryName","split","updateBookmarkTree","concat","disableHeaderButtons","location","hash","includes","bookmarkContextPanelElement","document","getElementById","favoriteContentButtonElement","querySelector","unfavoriteContentButtonElement","setPriorityButtonElement","contentId","getAttribute","bookmarkServiceURL","addUploadLicenseListener","setAttribute","fetch","method","headers","body","JSON","stringify","action","then","response","json","data","removeAttribute","_id","style","display","classList","remove","insertAdjacentHTML","handlePriorityButtonListener","bookmarkTopMenuElement","itemsWithChildren","querySelectorAll","addGetChildrenEventListener","checkBoxEventListener","addRemoveBookmarkEventListener","addPriorityBookmarkEventListener","addRefreshTreeEventListener","repositoryId","branch","length","forEach","item","contains","getChildrenEventListener","deprioritizeSelectedButton","prioritizeSelectedButton","checkboxes","contentIds","checkbox","nextElementSibling","push","refreshButtonElement","href","removeSelection","some","id","closest","widgetElement","uploadLicenseButtonElement","click","serviceUrl","licenseFile","target","files","formData","FormData","append","ok","reloadWidget","listElement","innerHTML","sublistElement","buildBookmarkTree","reset","insertAdjacentElement","checkAll","event","preventDefault","toggle","updateSelectionStatus","add","items","checked","checkedPriority","checkedNoPriority","priorityElement","isChecked","isPriority","toggleDisableElement","element","disable","params","tooltip","parentElement","_params$reset","createElement","child","itemElement","itemWrapperElement","appendChild","toggleElement","hasChildren","itemInfoElement","link","labelElement","checkboxElement","type","iconElement","src","icon","width","height","contentInfoElement","strongElement","textContent","displayName","paragraphElement","_path","bookmarkListWidget","bookmarkListWidgetURL","text","outerHTML","error","console","log","bookmarkWidget","bookmarkWidgetURL","removeSelectionButton"],"sources":["bookmark.js"],"sourcesContent":["function main () {\n  window.addEventListener('hashchange', function (e) {\n    const newURL = e.newURL\n    const repositoryName = newURL.split('main#/')[1].split('/')[0]\n\n    updateBookmarkTree(`com.enonic.cms.${repositoryName}`)\n    disableHeaderButtons()\n  })\n\n  if (!window.location.hash.includes('widget/bookmark/bookmark-list')) {\n    const bookmarkContextPanelElement = document.getElementById('bookmark__context-panel')\n    const favoriteContentButtonElement = document.querySelector('[data-id=\"favorite-content-button\"]')\n    const unfavoriteContentButtonElement = document.querySelector('[data-id=\"unfavorite-content-button\"]')\n    const setPriorityButtonElement = document.querySelector('[data-id=\"set-priority-button\"]')\n\n    const contentId = bookmarkContextPanelElement.getAttribute('data-content-id')\n    const bookmarkServiceURL = bookmarkContextPanelElement.getAttribute('data-bookmark-service-url')\n\n    addUploadLicenseListener(bookmarkContextPanelElement)\n\n    if (!bookmarkServiceURL) return\n\n    if (favoriteContentButtonElement) {\n      favoriteContentButtonElement.addEventListener('click', function () {\n        favoriteContentButtonElement.setAttribute('disabled', true)\n        fetch(bookmarkServiceURL, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ action: 'favorite', contentId })\n        }).then(response => response.json()).then(data => {\n          favoriteContentButtonElement.removeAttribute('disabled')\n          if (data && data._id) {\n            updateBookmarkTree()\n            favoriteContentButtonElement.style.display = 'none'\n            unfavoriteContentButtonElement.style.display = 'block'\n            setPriorityButtonElement.style.display = 'block'\n            setPriorityButtonElement.classList.remove('selected')\n          } else {\n            bookmarkContextPanelElement.insertAdjacentHTML('beforeend', '<p class=\"bookmark__context-panel__error\">It was not possible to bookmark this content</p>')\n          }\n        })\n      })\n    }\n\n    if (unfavoriteContentButtonElement) {\n      unfavoriteContentButtonElement.addEventListener('click', function () {\n        unfavoriteContentButtonElement.setAttribute('disabled', true)\n        fetch(bookmarkServiceURL, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ action: 'unfavorite', contentId })\n        }).then(response => response.json()).then(data => {\n          unfavoriteContentButtonElement.removeAttribute('disabled')\n          if (data && data._id) {\n            updateBookmarkTree()\n            unfavoriteContentButtonElement.style.display = 'none'\n            favoriteContentButtonElement.style.display = 'block'\n            setPriorityButtonElement.style.display = 'none'\n          } else {\n            bookmarkContextPanelElement.insertAdjacentHTML('beforeend', '<p class=\"bookmark__context-panel__error\">It was not possible to remove the bookmark</p>')\n          }\n        })\n      })\n    }\n\n    handlePriorityButtonListener({ contentId, bookmarkServiceURL, bookmarkContextPanelElement })\n  } else {\n    const bookmarkTopMenuElement = document.getElementById('bookmark__top-menu')\n    const itemsWithChildren = document.querySelectorAll('[data-content-id]')\n\n    if (!bookmarkTopMenuElement) return\n    if (!itemsWithChildren) return\n\n    addGetChildrenEventListener()\n    checkBoxEventListener()\n    addRemoveBookmarkEventListener()\n    addPriorityBookmarkEventListener()\n    addRefreshTreeEventListener()\n    addUploadLicenseListener(bookmarkTopMenuElement)\n  }\n}\n\nfunction addGetChildrenEventListener () {\n  const bookmarkTopMenuElement = document.getElementById('bookmark__top-menu')\n  const bookmarkServiceURL = bookmarkTopMenuElement.getAttribute('data-bookmark-service-url')\n  const repositoryId = bookmarkTopMenuElement.getAttribute('data-repository-id')\n  const branch = bookmarkTopMenuElement.getAttribute('data-branch')\n\n  const itemsWithChildren = document.querySelectorAll('[data-content-id].expandable')\n\n  if (!itemsWithChildren.length) return\n\n  itemsWithChildren.forEach(item => {\n    if (item.classList.contains('expandable')) {\n      item.addEventListener('click', () => getChildrenEventListener({ bookmarkServiceURL, branch, repositoryId, item }))\n    }\n  })\n}\n\nfunction addPriorityBookmarkEventListener () {\n  const deprioritizeSelectedButton = document.querySelector('[data-id=\"deprioritizeSelected\"]')\n  const prioritizeSelectedButton = document.querySelector('[data-id=\"prioritizeSelected\"]')\n  const bookmarkTopMenuElement = document.getElementById('bookmark__top-menu')\n  const bookmarkServiceURL = bookmarkTopMenuElement.getAttribute('data-bookmark-service-url')\n\n  deprioritizeSelectedButton && deprioritizeSelectedButton.addEventListener('click', () => {\n    const checkboxes = document.querySelectorAll('.item-wrapper label.checked')\n\n    if (!checkboxes.length) return\n\n    const contentIds = []\n    checkboxes.forEach(checkbox => {\n      if (checkbox.nextElementSibling.nextElementSibling.classList.contains('priority')) contentIds.push(checkbox.getAttribute('id'))\n    })\n\n    fetch(bookmarkServiceURL, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ action: 'remove_priority', contentIds })\n    }).then(response => response.json()).then(data => {\n      if (data && data._id) {\n        updateBookmarkTree()\n        disableHeaderButtons()\n      }\n    })\n  })\n\n  prioritizeSelectedButton && prioritizeSelectedButton.addEventListener('click', () => {\n    const checkboxes = document.querySelectorAll('.item-wrapper label.checked')\n\n    if (!checkboxes.length) return\n\n    const contentIds = []\n    checkboxes.forEach(checkbox => {\n      if (!checkbox.nextElementSibling.nextElementSibling.classList.contains('priority')) contentIds.push(checkbox.getAttribute('id'))\n    })\n\n    fetch(bookmarkServiceURL, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ action: 'add_priority', contentIds })\n    }).then(response => response.json()).then(data => {\n      if (data && data._id) {\n        updateBookmarkTree()\n        disableHeaderButtons()\n      }\n    })\n  })\n}\n\n/**\n * Event listener added to the refresh button in order to update the favorite contents tree\n */\nfunction addRefreshTreeEventListener () {\n  const refreshButtonElement = document.getElementById('refreshContent')\n  refreshButtonElement && refreshButtonElement.addEventListener('click', () => {\n    const repositoryName = window.location.href.split('main#/')[1].split('/')[0]\n\n    updateBookmarkTree(`com.enonic.cms.${repositoryName}`)\n    disableHeaderButtons()\n  })\n}\n\nfunction addRemoveBookmarkEventListener () {\n  const removeSelection = document.getElementById('removeSelection')\n  const bookmarkTopMenuElement = document.getElementById('bookmark__top-menu')\n  const bookmarkServiceURL = bookmarkTopMenuElement.getAttribute('data-bookmark-service-url')\n\n  removeSelection && removeSelection.addEventListener('click', () => {\n    const checkboxes = document.querySelectorAll('.item-wrapper label.checked')\n    const contentIds = []\n\n    if (!checkboxes.length) return\n\n    checkboxes.forEach(checkbox => contentIds.push(checkbox.getAttribute('id')))\n\n    fetch(bookmarkServiceURL, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ action: 'unfavorite', contentIds })\n    }).then(response => response.json()).then(data => {\n      if (data && data._id) {\n        checkboxes.forEach(checkbox => {\n          if (contentIds.some(id => id === checkbox.getAttribute('id'))) {\n            checkbox.closest('.item').remove()\n          }\n        })\n\n        disableHeaderButtons()\n      }\n    })\n  })\n}\n\n/**\n *\n * @param {Element} widgetElement\n * @returns\n */\nfunction addUploadLicenseListener (widgetElement) {\n  const uploadLicenseButtonElement = widgetElement.querySelector('#bookmark_upload_input')\n\n  if (!uploadLicenseButtonElement) return\n\n  uploadLicenseButtonElement.addEventListener('click', function () {\n    this.querySelector('input').click()\n  }, false)\n\n  uploadLicenseButtonElement.querySelector('input').addEventListener('change', function (e) {\n    const serviceUrl = this.getAttribute('data-license-service-url')\n    const licenseFile = e.target.files[0]\n\n    if (licenseFile) {\n      const formData = new FormData()\n      formData.append('license', licenseFile)\n\n      fetch(serviceUrl, {\n        method: 'POST',\n        body: formData\n      })\n        .then(response => {\n          if (response.ok) {\n            document.querySelector('.bookmark_license .error-message').style.display = 'none'\n            reloadWidget()\n          } else {\n            document.querySelector('.bookmark_license .error-message').style.display = 'block'\n          }\n        })\n        .catch(() => {\n          document.querySelector('.bookmark_license .error-message').style.display = 'none'\n        })\n    }\n  })\n}\n\nfunction updateBookmarkTree (repositoryName) {\n  const bookmarkTopMenuElement = document.getElementById('bookmark__top-menu')\n\n  if (!bookmarkTopMenuElement) return\n\n  const bookmarkServiceURL = bookmarkTopMenuElement.getAttribute('data-bookmark-service-url')\n  const repositoryId = repositoryName || bookmarkTopMenuElement.getAttribute('data-repository-id')\n  bookmarkTopMenuElement.setAttribute('data-repository-id', repositoryId)\n  const branch = bookmarkTopMenuElement.getAttribute('data-branch')\n\n  fetch(bookmarkServiceURL + `?repositoryId=${repositoryId}&branch=${branch}&action=get-all`).then(response => response.json()).then(data => {\n    const listElement = document.querySelector('.bookmark-list')\n\n    if (!listElement) return\n\n    listElement.innerHTML = ''\n    const sublistElement = buildBookmarkTree({ data, reset: true })\n    listElement.insertAdjacentElement('beforeend', sublistElement)\n  }).then(() => checkBoxEventListener())\n}\n\nfunction checkBoxEventListener () {\n  let checkboxes = document.querySelectorAll('.item-wrapper label')\n  const checkAll = document.querySelector('#checkAll')\n  const removeSelection = document.querySelector('#removeSelection')\n  const deprioritizeSelectedButton = document.querySelector('[data-id=\"deprioritizeSelected\"]')\n  const prioritizeSelectedButton = document.querySelector('[data-id=\"prioritizeSelected\"]')\n\n  checkboxes.forEach(item => {\n    if (item.getAttribute('listener') !== 'true') {\n      item.addEventListener('click', event => {\n        event.preventDefault()\n\n        item.setAttribute('listener', 'true')\n        if (checkAll.classList.contains('checked') && item.classList.contains('checked')) {\n          checkAll.classList.remove('checked')\n        }\n        item.classList.toggle('checked')\n\n        updateSelectionStatus()\n      })\n    }\n  })\n\n  if (checkAll && checkAll.getAttribute('listener') !== 'true') {\n    checkAll.setAttribute('listener', 'true')\n    checkAll.addEventListener('click', event => {\n      event.preventDefault()\n      checkboxes = document.querySelectorAll('.item-wrapper label')\n\n      if (!checkAll.classList.contains('checked')) {\n        checkAll.classList.add('checked')\n        checkboxes.forEach(item => {\n          if (!item.classList.contains('checked')) {\n            item.classList.add('checked')\n          }\n        })\n\n        removeSelection.classList.remove('disabled')\n      } else {\n        checkAll.classList.remove('checked')\n        checkboxes.forEach(item => {\n          if (item.classList.contains('checked')) {\n            item.classList.remove('checked')\n          }\n        })\n      }\n\n      updateSelectionStatus()\n    })\n  }\n\n  /**\n   * Disable/Enable the header buttons based on the current status of the checkboxes and priority defined\n   */\n  function updateSelectionStatus () {\n    checkboxes = document.querySelectorAll('.item-wrapper label')\n\n    const items = { checked: 0, checkedPriority: 0, checkedNoPriority: 0 }\n\n    checkboxes.forEach(item => {\n      const priorityElement = item.nextElementSibling.nextElementSibling\n\n      const isChecked = item.classList.contains('checked')\n      const isPriority = priorityElement.classList.contains('priority')\n      if (isChecked) {\n        items.checked++\n\n        if (isPriority) items.checkedPriority++\n        else items.checkedNoPriority++\n      }\n    })\n\n    if (items.checked > 0) toggleDisableElement({ element: removeSelection, disable: false })\n    else toggleDisableElement({ element: removeSelection, disable: true })\n\n    if (items.checked === 0) {\n      toggleDisableElement({ element: deprioritizeSelectedButton, disable: true })\n      toggleDisableElement({ element: prioritizeSelectedButton, disable: true })\n    } else {\n      if (items.checkedPriority > 0) toggleDisableElement({ element: deprioritizeSelectedButton, disable: false })\n      else toggleDisableElement({ element: deprioritizeSelectedButton, disable: true })\n\n      if (items.checkedNoPriority > 0) toggleDisableElement({ element: prioritizeSelectedButton, disable: false })\n      else toggleDisableElement({ element: prioritizeSelectedButton, disable: true })\n    }\n  }\n}\n\n/**\n * Adds 'disabled' class and disabled attribute to the HTML element\n * @param {Object} params\n * @param {HTMLElement} params.element\n * @param {Boolean} params.disable\n */\nfunction toggleDisableElement (params) {\n  if (!params.element) return\n\n  if (params.disable) {\n    params.element.classList.add('disabled')\n    params.element.setAttribute('disabled', '')\n    return\n  }\n\n  params.element.classList.remove('disabled')\n  params.element.removeAttribute('disabled')\n}\n\n/**\n * Add event listener to the priority button from context panel widget and handle the checked/unchecked button state\n * @param {Object} params\n * @param {String} params.contentId\n * @param {String} params.bookmarkServiceURL\n * @param {HTMLElement} params.bookmarkContextPanelElement\n */\nfunction handlePriorityButtonListener (params) {\n  const { contentId, bookmarkServiceURL, bookmarkContextPanelElement } = params\n  const setPriorityButtonElement = document.querySelector('[data-id=\"set-priority-button\"]')\n  const tooltip = document.querySelector('.priority-tooltip')\n\n  if (setPriorityButtonElement.getAttribute('listener') === 'true') return\n\n  setPriorityButtonElement.addEventListener('click', () => {\n    if (bookmarkContextPanelElement.querySelector('.bookmark__context-panel__error')) {\n      bookmarkContextPanelElement.querySelector('.bookmark__context-panel__error').remove()\n    }\n\n    fetch(bookmarkServiceURL, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ action: 'toggle_priority', contentId })\n    }).then(response => response.json()).then(data => {\n      setPriorityButtonElement.removeAttribute('disabled')\n\n      if (!data || !data._id) {\n        bookmarkContextPanelElement.insertAdjacentHTML('beforeend', '<p class=\"bookmark__context-panel__error\">It was not possible to remove priority from this content</p>')\n        return\n      }\n\n      updateBookmarkTree()\n      if (setPriorityButtonElement.classList.contains('selected')) tooltip.innerHTML = tooltip.getAttribute('data-add-priority-text')\n      else tooltip.innerHTML = tooltip.getAttribute('data-remove-priority-text')\n\n      setPriorityButtonElement.classList.toggle('selected')\n    })\n  })\n\n  setPriorityButtonElement.setAttribute('listener', 'true')\n}\n\n/**\n * Create each child and attach the 'click' event listener\n * @param {Object} params\n * @param {String} params.bookmarkServiceURL\n * @param {String} params.repositoryId\n * @param {String} params.branch\n * @param {HTMLElement} params.item\n */\nfunction getChildrenEventListener (params) {\n  const { bookmarkServiceURL, branch, repositoryId, item } = params\n  const contentId = item.getAttribute('data-content-id')\n\n  if (!item.classList.contains('expanded')) {\n    fetch(bookmarkServiceURL + `?contentId=${contentId}&repositoryId=${repositoryId}&branch=${branch}&action=get-children`).then(response => response.json()).then(data => {\n      const sublistElement = buildBookmarkTree({ data })\n      item.parentElement.parentElement.insertAdjacentElement('beforeend', sublistElement)\n\n      item.classList.add('expanded')\n    })\n  } else {\n    item.classList.remove('expanded')\n    item.parentElement.parentElement.querySelector('.bookmark-sublist').remove()\n  }\n}\n\n/**\n *\n * @param {Object} params\n * @param {Object[]} params.data\n * @param {Boolean} [params.reset=false] if true, the bookmark-list element should be reset before\n * @returns\n */\nfunction buildBookmarkTree (params) {\n  const { data, reset = false } = params\n\n  const bookmarkTopMenuElement = document.getElementById('bookmark__top-menu')\n  const bookmarkServiceURL = bookmarkTopMenuElement.getAttribute('data-bookmark-service-url')\n  const repositoryId = bookmarkTopMenuElement.getAttribute('data-repository-id')\n  const branch = bookmarkTopMenuElement.getAttribute('data-branch')\n\n  const sublistElement = document.createElement('div')\n  if (!reset) sublistElement.classList.add('bookmark-sublist')\n\n  data.forEach(child => {\n    const itemElement = document.createElement('div')\n    itemElement.classList.add('item')\n\n    const itemWrapperElement = document.createElement('div')\n    itemWrapperElement.classList.add('item-wrapper')\n\n    itemElement.appendChild(itemWrapperElement)\n\n    const toggleElement = document.createElement('div')\n    toggleElement.classList.add('toggle', 'icon', 'expand')\n    if (child.hasChildren) {\n      toggleElement.setAttribute('data-content-id', child._id)\n      toggleElement.classList.add('expandable')\n      toggleElement.addEventListener('click', () => getChildrenEventListener({ bookmarkServiceURL, branch, repositoryId, item: toggleElement }))\n    }\n\n    const itemInfoElement = document.createElement('a')\n    itemInfoElement.href = child.link\n    itemInfoElement.target = '_blank'\n    itemInfoElement.classList.add('item-info')\n    if (child.isPriority) itemInfoElement.classList.add('priority')\n\n    if (reset) {\n      const labelElement = document.createElement('label')\n      labelElement.id = child._id\n      const checkboxElement = document.createElement('input')\n      checkboxElement.type = 'checkbox'\n      labelElement.appendChild(checkboxElement)\n      itemWrapperElement.appendChild(labelElement)\n    }\n\n    itemWrapperElement.appendChild(toggleElement)\n    itemWrapperElement.appendChild(itemInfoElement)\n\n    const iconElement = document.createElement('img')\n    iconElement.src = child.icon\n    iconElement.width = 32\n    iconElement.height = 32\n\n    const contentInfoElement = document.createElement('div')\n    contentInfoElement.classList.add('content-info')\n\n    itemInfoElement.appendChild(iconElement)\n    itemInfoElement.appendChild(contentInfoElement)\n\n    const strongElement = document.createElement('strong')\n    strongElement.textContent = child.displayName\n\n    const paragraphElement = document.createElement('p')\n    paragraphElement.textContent = child._path\n\n    contentInfoElement.appendChild(strongElement)\n    contentInfoElement.appendChild(paragraphElement)\n\n    sublistElement.appendChild(itemElement)\n  })\n\n  return sublistElement\n}\n\nfunction reloadWidget () {\n  const bookmarkListWidget = document.querySelector('#app-bookmark-list')\n  const bookmarkListWidgetURL = bookmarkListWidget && bookmarkListWidget.getAttribute('data-widget-url')\n\n  if (bookmarkListWidgetURL) {\n    fetch(bookmarkListWidgetURL, {\n      method: 'GET'\n    })\n      .then(response => response.text())\n      .then(response => {\n        if (response) {\n          bookmarkListWidget.outerHTML = response\n          main()\n        }\n      }).catch(error => console.log(error))\n  }\n\n  const bookmarkWidget = document.querySelector('#app-bookmark')\n  const bookmarkWidgetURL = bookmarkWidget && bookmarkWidget.getAttribute('data-widget-url')\n\n  if (bookmarkWidgetURL) {\n    fetch(bookmarkWidgetURL, {\n      method: 'GET'\n    })\n      .then(response => response.text())\n      .then(response => {\n        if (response) {\n          bookmarkWidget.parentElement.innerHTML = response\n          main()\n        }\n      })\n  }\n}\n\nfunction disableHeaderButtons () {\n  const removeSelectionButton = document.getElementById('removeSelection')\n  const deprioritizeSelectedButton = document.querySelector('[data-id=\"deprioritizeSelected\"]')\n  const prioritizeSelectedButton = document.querySelector('[data-id=\"prioritizeSelected\"]')\n\n  document.getElementById('checkAll').classList.remove('checked')\n\n  toggleDisableElement({ element: removeSelectionButton, disable: true })\n  toggleDisableElement({ element: deprioritizeSelectedButton, disable: true })\n  toggleDisableElement({ element: prioritizeSelectedButton, disable: true })\n}\n\nmain()\n"],"mappings":"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"}